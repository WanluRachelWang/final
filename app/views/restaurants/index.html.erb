<style type="text/css">
  #map_canvas { 
  	height: 100% 
  }
  .map-div{
  	height: 40em;
  }

  .business{
	  display: block;
	  margin-left: auto;
	  margin-right: auto;
	  text-align: center;
	  border-radius: 5px;
	  height: 150px;
	  border: 1px solid #DDD;
	  margin-bottom: 10px;
	  padding-top: 15px;
	  background-color: #F1F1F1;
  }

</style>

<div class="container">
	<div class="row map-div">
    <div id="map_canvas" style="width:100%; height:100%"></div>
	</div>

	<div class ="row">
	<% @businesses.each do |business| %>
		<div class = "col-md-6">
			<div class = "business">
				<div class = "col-md-3">
					<%= image_tag business.image_url %>
				</div>
				<div class = "col-md-9">
					<%= business.name %>
					<%= business.location.display_address%>
					<%= image_tag business.rating_img_url_small %>
					<%= business.snippet_text %>
				</div>
			</div>
		</div>
	<% end %>
	</div>

</div>

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyApNBc6Vy0Ayi38rhGcxm6T8fkh_VoNh9Y&sensor=SET_TO_TRUE_OR_FALSE"></script>


<script type="text/javascript">

var map;

function initialize() {

	  var mapOptions = {
	    zoom: 13
	  };
	  map = new google.maps.Map(document.getElementById('map_canvas'),
	      mapOptions);

	  // Try HTML5 geolocation
	  if(navigator.geolocation) {
	    navigator.geolocation.getCurrentPosition(function(position) {
	      var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

	      var infowindow = new google.maps.InfoWindow({
	        map: map,
	        position: pos,
	        content: 'You are here'
	      });

	      map.setCenter(pos);

	    }, function() {
	      handleNoGeolocation(true);
	    });

	  } else {
	    // Browser doesn't support Geolocation
	    handleNoGeolocation(false);
	  }
	}

  $(document).ready(function(){
  	//initialize();
  });

</script>